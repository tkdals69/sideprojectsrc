# í™˜ê²½ë³€ìˆ˜ ë§¤í•‘

## Docker Compose â†’ Kubernetes ì „í™˜ ë§¤í•‘

### ê³µí†µ í™˜ê²½ë³€ìˆ˜

| í™˜ê²½ë³€ìˆ˜ | Docker Compose | Kubernetes | ë¦¬ì†ŒìŠ¤ íƒ€ì… | ë¹„ê³  |
|---------|---------------|------------|------------|------|
| `DB_HOST` | `postgres` | `postgres-service` | ConfigMap | í˜¸ìŠ¤íŠ¸ëª… ë³€ê²½ |
| `DB_PORT` | `5432` | `5432` | ConfigMap | - |
| `DB_USER` | `postgres` | `postgres` | ConfigMap | - |
| `DB_PASSWORD` | `password` | `<ê°•ë ¥í•œ ë¹„ë°€ë²ˆí˜¸>` | **Secret** | ğŸ”’ |
| `DB_NAME` | `mini_commerce` | `mini_commerce` | ConfigMap | - |
| `DATABASE_URL` | `postgresql://postgres:password@postgres:5432/mini_commerce` | `postgresql://postgres:<password>@postgres-service:5432/mini_commerce` | **Secret** | ğŸ”’ í˜¸ìŠ¤íŠ¸ëª… ë³€ê²½ |
| `NODE_ENV` | `development` | `production` | ConfigMap | í™˜ê²½ ë³€ê²½ |
| `LOG_LEVEL` | `debug` | `info` | ConfigMap | í™˜ê²½ ë³€ê²½ |

---

## ì„œë¹„ìŠ¤ë³„ í™˜ê²½ë³€ìˆ˜

### Auth Service

| í™˜ê²½ë³€ìˆ˜ | ê°’ | ë¦¬ì†ŒìŠ¤ íƒ€ì… |
|---------|---|------------|
| `PORT` | `3001` | ConfigMap |
| `JWT_SECRET` | `<openssl rand -base64 32>` | **Secret** ğŸ”’ |
| `JWT_EXPIRES_IN` | `24h` | ConfigMap |

**+ ê³µí†µ DB í™˜ê²½ë³€ìˆ˜**

---

### Catalog Service

| í™˜ê²½ë³€ìˆ˜ | ê°’ | ë¦¬ì†ŒìŠ¤ íƒ€ì… |
|---------|---|------------|
| `PORT` | `8080` | ConfigMap |

**+ ê³µí†µ DB í™˜ê²½ë³€ìˆ˜**

---

### Cart Service

| í™˜ê²½ë³€ìˆ˜ | ê°’ | ë¦¬ì†ŒìŠ¤ íƒ€ì… |
|---------|---|------------|
| `PORT` | `3003` | ConfigMap |

**+ ê³µí†µ DB í™˜ê²½ë³€ìˆ˜**

---

### Order Service (Spring Boot)

| í™˜ê²½ë³€ìˆ˜ | ê°’ | ë¦¬ì†ŒìŠ¤ íƒ€ì… | ë¹„ê³  |
|---------|---|------------|------|
| `PORT` | `8080` | ConfigMap | |
| `SPRING_DATASOURCE_URL` | `jdbc:postgresql://postgres-service:5432/mini_commerce` | ConfigMap | í˜¸ìŠ¤íŠ¸ëª… ë³€ê²½ |
| `SPRING_DATASOURCE_USERNAME` | `postgres` | ConfigMap | |
| `SPRING_DATASOURCE_PASSWORD` | `<ê°•ë ¥í•œ ë¹„ë°€ë²ˆí˜¸>` | **Secret** ğŸ”’ | |
| `SPRING_PROFILES_ACTIVE` | `production` | ConfigMap | ì‹ ê·œ ì¶”ê°€ |

---

### Inventory Service

| í™˜ê²½ë³€ìˆ˜ | ê°’ | ë¦¬ì†ŒìŠ¤ íƒ€ì… |
|---------|---|------------|
| `PORT` | `3005` | ConfigMap |

**+ ê³µí†µ DB í™˜ê²½ë³€ìˆ˜**

---

### Payment Service

| í™˜ê²½ë³€ìˆ˜ | Docker Compose | Kubernetes | ë¦¬ì†ŒìŠ¤ íƒ€ì… |
|---------|---------------|------------|------------|
| `NODE_ENV` | `production` | `production` | ConfigMap |
| `PORT` | `3005` | `3005` | ConfigMap |
| `ORDER_SERVICE_URL` | `http://mini-commerce-order:8080` | `http://order-service:8080` | ConfigMap |
| `CART_SERVICE_URL` | `http://mini-commerce-cart:3003` | `http://cart-service:3003` | ConfigMap |
| `NOTIFICATION_SERVICE_URL` | `http://mini-commerce-notification:3007` | `http://notification-service:3007` | ConfigMap |

---

### Notification Service

| í™˜ê²½ë³€ìˆ˜ | ê°’ | ë¦¬ì†ŒìŠ¤ íƒ€ì… |
|---------|---|------------|
| `PORT` | `3007` | ConfigMap |

**+ ê³µí†µ DB í™˜ê²½ë³€ìˆ˜**

---

## ConfigMap êµ¬ì¡°

```
common-config          # DB ì—°ê²° ì •ë³´, í™˜ê²½ ì„¤ì •
auth-config           # PORT, JWT_EXPIRES_IN
catalog-config        # PORT
cart-config           # PORT
order-config          # PORT, SPRING_* ì„¤ì •
inventory-config      # PORT
payment-config        # PORT, ì„œë¹„ìŠ¤ URLë“¤
notification-config   # PORT
```

---

## Secret êµ¬ì¡°

```
postgres-secret           # DB_PASSWORD, SPRING_DATASOURCE_PASSWORD
auth-secret              # JWT_SECRET
database-url-secret      # DATABASE_URL (ë¹„ë°€ë²ˆí˜¸ í¬í•¨)
```

---

## ì£¼ìš” ë³€ê²½ì‚¬í•­

### 1. ì„œë¹„ìŠ¤ í˜¸ìŠ¤íŠ¸ëª… ë³€ê²½
- `postgres` â†’ `postgres-service`
- `mini-commerce-*` â†’ `*-service`

### 2. ì„œë¹„ìŠ¤ URL ë³€ê²½
| Before | After |
|--------|-------|
| `http://mini-commerce-order:8080` | `http://order-service:8080` |
| `http://mini-commerce-cart:3003` | `http://cart-service:3003` |
| `http://mini-commerce-notification:3007` | `http://notification-service:3007` |

### 3. í¬íŠ¸
- Docker Compose: ì™¸ë¶€:ë‚´ë¶€ ë§¤í•‘ (ì˜ˆ: `3002:8080`)
- Kubernetes: ContainerëŠ” ë‚´ë¶€ í¬íŠ¸ë§Œ, Serviceê°€ ë§¤í•‘ ë‹´ë‹¹

### 4. Secret ìƒì„± ëª…ë ¹ì–´

```bash
# JWT Secret ìƒì„±
openssl rand -base64 32

# DB Password ìƒì„±
openssl rand -base64 24
```

---

## ë³´ì•ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] JWT_SECRETì„ ê°•ë ¥í•œ í‚¤ë¡œ ë³€ê²½
- [ ] DB_PASSWORDë¥¼ ê°•ë ¥í•œ ë¹„ë°€ë²ˆí˜¸ë¡œ ë³€ê²½
- [ ] Secret YAMLì„ .gitignoreì— ì¶”ê°€
- [ ] Sealed Secrets ë˜ëŠ” External Secrets ì‚¬ìš© ê³ ë ¤

